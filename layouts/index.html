{{ define "main" }}
{{ $microposts := .Site.Taxonomies.categories.micro }}
{{ $paginator := .Paginate (.Site.Taxonomies.categories.essay) 5 }}


<div class="posts-wrapper">
	<div class="post-list">
	<h2>Blog Post</h2>
	{{ if or .IsHome .Site.Params.paginate_categories }}
			{{ range first 1 $paginator.Pages }}
				{{ partial "post-item.html" . }}
			{{ end }}
			{{ partial "mobile-callout.html" . }}
			{{ range (after 1 $paginator.Pages) }}
				{{ partial "post-item.html" . }}
			{{ end }}
	{{ else }}
			{{ range first 1 $paginator.Pages }}
				{{ partial "post-item.html" . }}
			{{ end }}
			{{ partial "mobile-callout.html" . }}
			{{ range (after 1 $paginator.Pages) }}
				{{ partial "post-item.html" . }}
			{{ end }}
	{{ end }}

	</div>

	<div class="sidebar">
		<div class="status box">
		<h2>Current Status</h2>
		<script src="https://status.lol/gr36.js?time&link&fluent"></script>
		</div>
		<div class="micropost box">
			<h2>Micro Blog</h2>
			{{ if or .IsHome .Site.Params.paginate_categories }}
				{{ range  first 3 $microposts }}
					{{ partial "post-item.html" . }}
				{{ end }}
			{{ else }}
			{{ range $microposts }}
					{{ partial "post-item.html" . }}
				{{ end }}
			{{ end }}
			</div>
		<div class="reading box">
			<h2>Reading</h2>
			{{ range first 1 (.Site.Data.bookshelves.currentlyreading) }}
				<a href="https://micro.blog/books/{{ .isbn }}">
            <img src="{{ .cover_url }}"> <span class="bookshelf_title">{{ .title }}</span>
				<span class="book-author">by {{ .author }}</span></a>
			{{ end }}
		</div>
		<div class="advert box">
			<h2>Advert</h2>
			<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CESI5KJI&placement=gregmorriscouk" id="_carbonads_js"></script>
		</div>
		<div class="categories box">
			<h2>Categories</h2>
			{{range ($.Site.GetPage "taxonomyTerm" "categories").Pages }}
				<div><a href="{{ .Permalink }}">{{ .Title }}</a></div>
			{{ end }}
		</div>
	</div>
</div>


{{ if .IsHome }}
	{{ if .Site.Params.paginate_home }}
		{{ partial "pagination" . }}
	{{ end }}
{{ else if .Site.Params.paginate_categories }}
	{{ partial "pagination" . }}
{{ end }}

{{ end }}
